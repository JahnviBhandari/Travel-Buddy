<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Buddy - Your Perfect Travel Companion</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .bounce {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }
        .match-image {
            width: 100%;
            height: 160px;
            object-fit: cover;
            object-position: center;
        }
        .chat-image {
            width: 40px;
            height: 40px;
            object-fit: cover;
            object-position: center;
        }
        .active-filter {
            background-color: #13a4ec;
            color: white;
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: { 
                        primary: "#13a4ec", 
                        "background-light": "#f6f7f8", 
                        "background-dark": "#101c22" 
                    },
                    fontFamily: { display: ["Plus Jakarta Sans"] },
                }
            }
        }
    </script>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-gray-800 dark:text-gray-200">
    <!-- Main Container -->
    <div id="app" class="min-h-screen">
        <!-- Landing Page -->
        <div id="landingPage" class="h-screen w-full bg-cover bg-center flex items-center justify-center" 
            style="background-image: url('https://images.unsplash.com/photo-1488646953014-85cb44e25828?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');">
            <div class="bg-black/40 p-8 rounded-lg text-center max-w-2xl mx-4 slide-up">
                <h1 class="text-5xl font-extrabold text-white mb-4">Your Perfect Travel Companion</h1>
                <p class="text-lg text-gray-200 mb-6">Find like-minded adventurers to explore the world with. Connect, plan, and embark on unforgettable journeys together.</p>
                <button onclick="showAuthPage()" class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary/90 transition text-lg font-medium bounce">Get Started</button>
                <p class="text-gray-300 mt-4">Already have an account? <button onclick="showAuthPage()" class="text-white font-medium underline">Log in here</button></p>
            </div>
        </div>

        <!-- Authentication Page -->
        <div id="authPage" class="hidden min-h-screen flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-900 p-8 rounded-lg w-full max-w-md shadow-lg slide-up">
                <button onclick="showPage('landingPage')" class="flex items-center gap-2 text-gray-600 dark:text-gray-400 mb-6 hover:text-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                    </svg>
                    Back to Home
                </button>
                
                <h2 class="text-2xl font-bold mb-6 text-center">Join Travel Buddy</h2>
                
                <!-- Tabs for Login/Signup -->
                <div class="flex mb-6 border-b border-gray-200 dark:border-gray-700">
                    <button id="loginTab" class="flex-1 py-2 font-medium text-primary border-b-2 border-primary">Login</button>
                    <button id="signupTab" class="flex-1 py-2 font-medium text-gray-500 dark:text-gray-400">Sign Up</button>
                </div>
                
                <!-- Login Form -->
                <div id="loginForm" class="space-y-4">
                    <div>
                        <label class="block mb-1 font-medium">Email</label>
                        <input type="email" id="loginEmail" placeholder="Enter your email" class="w-full p-3 rounded border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    <div>
                        <label class="block mb-1 font-medium">Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter your password" class="w-full p-3 rounded border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    <button onclick="login()" class="w-full bg-primary text-white px-4 py-3 rounded-lg hover:bg-primary/90 font-medium">Login</button>
                    <p class="text-center text-sm text-gray-600 dark:text-gray-400">Don't have an account? <button onclick="switchToSignup()" class="text-primary font-medium">Sign up</button></p>
                </div>
                
                <!-- Signup Form -->
                <div id="signupForm" class="hidden space-y-4">
                    <div>
                        <label class="block mb-1 font-medium">Full Name</label>
                        <input type="text" id="signupName" placeholder="Enter your full name" class="w-full p-3 rounded border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    <div>
                        <label class="block mb-1 font-medium">Email</label>
                        <input type="email" id="signupEmail" placeholder="Enter your email" class="w-full p-3 rounded border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    <div>
                        <label class="block mb-1 font-medium">Password</label>
                        <input type="password" id="signupPassword" placeholder="Create a password" class="w-full p-3 rounded border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    <div>
                        <label class="block mb-1 font-medium">Confirm Password</label>
                        <input type="password" id="signupConfirmPassword" placeholder="Confirm your password" class="w-full p-3 rounded border border-gray-300 dark:border-gray-700 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    <button onclick="signup()" class="w-full bg-primary text-white px-4 py-3 rounded-lg hover:bg-primary/90 font-medium">Create Account</button>
                    <p class="text-center text-sm text-gray-600 dark:text-gray-400">Already have an account? <button onclick="switchToLogin()" class="text-primary font-medium">Login</button></p>
                </div>
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profilePage" class="hidden min-h-screen">
            <nav class="p-4 bg-white dark:bg-gray-900 flex justify-between items-center shadow-sm">
                <div class="flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    <span class="font-bold text-xl">Travel Buddy</span>
                </div>
                <div class="flex gap-4">
                    <button onclick="showPage('profilePage')" class="hover:text-primary font-medium">Profile</button>
                    <button onclick="showPage('matchesPage')" class="hover:text-primary font-medium">Find Matches</button>
                    <button onclick="logout()" class="hover:text-primary font-medium">Logout</button>
                </div>
            </nav>

            <main class="container mx-auto p-6 max-w-3xl">
                <h1 class="text-3xl font-bold mb-6">Complete Your Profile</h1>
                <form id="profileForm" class="space-y-6 bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block mb-2 font-medium">Full Name</label>
                            <input type="text" id="full-name" placeholder="Enter your full name" class="w-full rounded border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">Age</label>
                            <input type="number" id="age" placeholder="Your age" class="w-full rounded border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block mb-2 font-medium">Current Location</label>
                        <input type="text" id="location" placeholder="City, Country" class="w-full rounded border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    
                    <div>
                        <label class="block mb-2 font-medium">Destination</label>
                        <input type="text" id="destination" placeholder="Where do you want to travel?" class="w-full rounded border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block mb-2 font-medium">Travel Dates</label>
                            <input type="date" id="travel-date" class="w-full rounded border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">Travel Style</label>
                            <select id="travel-style" class="w-full rounded border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent">
                                <option value="">Select Travel Style</option>
                                <option value="Adventurer">Adventurer</option>
                                <option value="Chill">Chill & Relaxed</option>
                                <option value="Foodie">Foodie</option>
                                <option value="Cultural">Cultural Explorer</option>
                                <option value="Explorer">Urban Explorer</option>
                                <option value="Backpacker">Budget Backpacker</option>
                                <option value="Luxury">Luxury Traveler</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block mb-2 font-medium">Interests</label>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Hiking" class="rounded text-primary focus:ring-primary"/> Hiking
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Photography" class="rounded text-primary focus:ring-primary"/> Photography
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Food Tasting" class="rounded text-primary focus:ring-primary"/> Food Tasting
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Museums" class="rounded text-primary focus:ring-primary"/> Museums
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="City Exploration" class="rounded text-primary focus:ring-primary"/> City Exploration
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Beaches" class="rounded text-primary focus:ring-primary"/> Beaches
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Nightlife" class="rounded text-primary focus:ring-primary"/> Nightlife
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Shopping" class="rounded text-primary focus:ring-primary"/> Shopping
                            </label>
                            <label class="flex items-center gap-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                                <input type="checkbox" value="Nature" class="rounded text-primary focus:ring-primary"/> Nature
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block mb-2 font-medium">Short Bio</label>
                        <textarea id="short-bio" rows="4" placeholder="Tell us about yourself, your travel preferences, and what you're looking for in a travel buddy..." class="w-full rounded border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"></textarea>
                    </div>
                    
                    <button type="submit" class="w-full bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary/90 font-medium text-lg">Save Profile & Find Matches</button>
                </form>
            </main>
        </div>

        <!-- Find Matches Page -->
        <div id="matchesPage" class="hidden min-h-screen">
            <nav class="p-4 bg-white dark:bg-gray-900 flex justify-between items-center shadow-sm">
                <div class="flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    <span class="font-bold text-xl">Travel Buddy</span>
                </div>
                <div class="flex gap-4">
                    <button onclick="showPage('profilePage')" class="hover:text-primary font-medium">Profile</button>
                    <button onclick="showPage('matchesPage')" class="hover:text-primary font-medium">Find Matches</button>
                    <button onclick="logout()" class="hover:text-primary font-medium">Logout</button>
                </div>
            </nav>

            <main class="container mx-auto p-6">
                <h1 class="text-3xl font-bold mb-2">Find Your Travel Match</h1>
                <p class="text-gray-600 dark:text-gray-400 mb-6">Based on your profile, we've found these potential travel buddies for you.</p>
                
                <div class="mb-6 flex flex-wrap gap-2">
                    <button id="filterAll" class="bg-primary text-white px-4 py-2 rounded-full text-sm active-filter" onclick="filterMatches('all')">All</button>
                    <button id="filterDestination" class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600" onclick="filterMatches('destination')">Same Destination</button>
                    <button id="filterStyle" class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600" onclick="filterMatches('style')">Similar Travel Style</button>
                    <button id="filterDates" class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600" onclick="filterMatches('dates')">Matching Dates</button>
                </div>
                
                <div id="matchProfiles" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </main>
        </div>

        <!-- Chat Page -->
        <div id="chatPage" class="hidden min-h-screen">
            <nav class="p-4 bg-white dark:bg-gray-900 flex justify-between items-center shadow-sm">
                <div class="flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    <span class="font-bold text-xl">Travel Buddy</span>
                </div>
                <div class="flex gap-4">
                    <button onclick="showPage('profilePage')" class="hover:text-primary font-medium">Profile</button>
                    <button onclick="showPage('matchesPage')" class="hover:text-primary font-medium">Find Matches</button>
                    <button onclick="logout()" class="hover:text-primary font-medium">Logout</button>
                </div>
            </nav>

            <main class="container mx-auto p-6 max-w-4xl">
                <div class="bg-white dark:bg-gray-900 rounded-lg shadow-md overflow-hidden">
                    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center gap-3">
                        <img id="chatUserImage" src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=200&q=80" alt="User" class="chat-image">
                        <div>
                            <h2 id="chatUserName" class="font-semibold">Michael Brown</h2>
                            <p id="chatUserInfo" class="text-sm text-gray-500 dark:text-gray-400">Traveling to Rome, Italy • Adventurer</p>
                        </div>
                    </div>
                    
                    <div id="chatBox" class="p-4 h-96 overflow-y-auto bg-gray-50 dark:bg-gray-800">
                        <!-- Messages will be inserted here -->
                    </div>
                    
                    <div class="p-4 border-t border-gray-200 dark:border-gray-700 flex gap-2">
                        <input id="messageInput" placeholder="Type a message..." class="flex-1 rounded border border-gray-300 dark:border-gray-700 p-3 bg-background-light dark:bg-background-dark text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"/>
                        <button onclick="sendMessage()" class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary/90 font-medium">Send</button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Add Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDNYVcB9b1YdUZN5GujLig8et95VPIE9Zw",
            authDomain: "travel-buddy-website.firebaseapp.com",
            projectId: "travel-buddy-website",
            storageBucket: "travel-buddy-website.firebasestorage.app",
            messagingSenderId: "900364159765",
            appId: "1:900364159765:web:6af1beb72506af7015771c",
            measurementId: "G-BGN23DE8HP"
        };

        // Initialize Firebase (using compatibility version)
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        // Sample data for demonstration with clearer images
        const sampleMatches = [
            { 
                id: 1, 
                name: "Michael Brown", 
                age: 28, 
                location: "Rome, Italy", 
                destination: "Bali, Indonesia",
                travelDate: "2023-11-15",
                style: "Explorer", 
                interests: ["Museums", "City Exploration", "Food Tasting"], 
                bio: "Love exploring new cities and trying local cuisine. Looking for someone to share adventures with!",
                img: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                compatibility: 92
            },
            { 
                id: 2, 
                name: "Sophie Turner", 
                age: 26, 
                location: "New York, USA", 
                destination: "Tokyo, Japan",
                travelDate: "2023-12-01",
                style: "Adventurer", 
                interests: ["Hiking", "Photography", "Nature"], 
                bio: "Passionate hiker and photographer. Always up for an adventure in nature!",
                img: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                compatibility: 87
            },
            { 
                id: 3, 
                name: "David Lee", 
                age: 32, 
                location: "Seoul, South Korea", 
                destination: "Bangkok, Thailand",
                travelDate: "2023-11-20",
                style: "Foodie", 
                interests: ["Food Tasting", "Beaches", "Nightlife"], 
                bio: "Food enthusiast looking to explore the culinary scenes of Southeast Asia.",
                img: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                compatibility: 78
            },
            { 
                id: 4, 
                name: "Emma Wilson", 
                age: 29, 
                location: "London, UK", 
                destination: "Bali, Indonesia",
                travelDate: "2023-11-15",
                style: "Chill", 
                interests: ["Beaches", "Yoga", "Nature"], 
                bio: "Yoga teacher looking for a relaxing beach vacation with good company.",
                img: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                compatibility: 95
            },
            { 
                id: 5, 
                name: "Alex Johnson", 
                age: 31, 
                location: "Toronto, Canada", 
                destination: "Tokyo, Japan",
                travelDate: "2023-12-05",
                style: "Cultural", 
                interests: ["Museums", "Temples", "City Exploration"], 
                bio: "History buff excited to explore Japan's rich culture and traditions.",
                img: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                compatibility: 83
            },
            { 
                id: 6, 
                name: "Maria Garcia", 
                age: 27, 
                location: "Madrid, Spain", 
                destination: "Bangkok, Thailand",
                travelDate: "2023-11-25",
                style: "Backpacker", 
                interests: ["Street Food", "Markets", "Adventure Sports"], 
                bio: "Budget traveler looking for authentic experiences and new friendships.",
                img: "https://images.unsplash.com/photo-1534751516642-a1af1ef26a56?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                compatibility: 76
            }
        ];

        // Current user data
        let currentUser = null;
        let currentChatWith = null;
        let currentFilter = 'all';

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Always start with the landing page
            showPage('landingPage');

            // Set up form submissions
            document.getElementById('profileForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveProfile();
            });

            // Set up tab switching
            document.getElementById('loginTab').addEventListener('click', switchToLogin);
            document.getElementById('signupTab').addEventListener('click', switchToSignup);
        });

        // Page navigation functions
        function showPage(pageId) {
            // Hide all pages
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('authPage').classList.add('hidden');
            document.getElementById('profilePage').classList.add('hidden');
            document.getElementById('matchesPage').classList.add('hidden');
            document.getElementById('chatPage').classList.add('hidden');

            // Show the requested page
            document.getElementById(pageId).classList.remove('hidden');

            // If showing matches page, render matches
            if (pageId === 'matchesPage') {
                renderMatches();
            }
        }

        function showAuthPage() {
            showPage('authPage');
            switchToLogin();
        }

        // Authentication functions
        function switchToLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('signupForm').classList.add('hidden');
            document.getElementById('loginTab').classList.add('text-primary', 'border-primary');
            document.getElementById('loginTab').classList.remove('text-gray-500', 'dark:text-gray-400');
            document.getElementById('signupTab').classList.add('text-gray-500', 'dark:text-gray-400');
            document.getElementById('signupTab').classList.remove('text-primary', 'border-primary');
        }

        function switchToSignup() {
            document.getElementById('signupForm').classList.remove('hidden');
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupTab').classList.add('text-primary', 'border-primary');
            document.getElementById('signupTab').classList.remove('text-gray-500', 'dark:text-gray-400');
            document.getElementById('loginTab').classList.add('text-gray-500', 'dark:text-gray-400');
            document.getElementById('loginTab').classList.remove('text-primary', 'border-primary');
        }

        async function login() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    if (!email || !password) {
        alert('Please enter both email and password.');
        return;
    }
    
    try {
        const userCredential = await firebase.auth().signInWithEmailAndPassword(email, password);
        const user = userCredential.user;
        
        // Get user data from Firestore
        const userDoc = await firebase.firestore().collection('users').doc(user.uid).get();
        
        if (userDoc.exists) {
            currentUser = {
                id: user.uid,
                ...userDoc.data()
            };
            
            if (currentUser.profileCompleted) {
                showPage('matchesPage');
            } else {
                showPage('profilePage');
            }
        } else {
            alert('User data not found.');
        }
        
    } catch (error) {
        console.error('Login error:', error);
        alert('Login failed: ' + error.message);
    }
}

        async function signup() {
    const name = document.getElementById('signupName').value;
    const email = document.getElementById('signupEmail').value;
    const password = document.getElementById('signupPassword').value;
    const confirmPassword = document.getElementById('signupConfirmPassword').value;
    
    if (!name || !email || !password || !confirmPassword) {
        alert('Please fill in all fields.');
        return;
    }
    
    if (password !== confirmPassword) {
        alert('Passwords do not match.');
        return;
    }
    
    if (password.length < 6) {
        alert('Password must be at least 6 characters long.');
        return;
    }
    
    try {
        // Create user in Firebase Authentication
        const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);
        const user = userCredential.user;
        
        // Save user data to Firestore
        await firebase.firestore().collection('users').doc(user.uid).set({
            name: name,
            email: email,
            profileCompleted: false,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        currentUser = {
            id: user.uid,
            name: name,
            email: email,
            profileCompleted: false
        };
        
        showPage('profilePage');
        
    } catch (error) {
        console.error('Signup error:', error);
        alert('Signup failed: ' + error.message);
    }
}

        function logout() {
    firebase.auth().signOut().then(() => {
        currentUser = null;
        showPage('landingPage');
    });
}

        // Profile functions
        function saveProfile() {
            const name = document.getElementById('full-name').value;
            const age = document.getElementById('age').value;
            const location = document.getElementById('location').value;
            const destination = document.getElementById('destination').value;
            const travelDate = document.getElementById('travel-date').value;
            const travelStyle = document.getElementById('travel-style').value;
            const interests = Array.from(document.querySelectorAll('input[type=checkbox]:checked')).map(i => i.value);
            const bio = document.getElementById('short-bio').value;
            
            if (!name || !age || !location || !destination || !travelDate || !travelStyle || interests.length === 0 || !bio) {
                alert('Please fill in all fields.');
                return;
            }
            
            // Update user profile
            currentUser.profile = {
                name,
                age,
                location,
                destination,
                travelDate,
                travelStyle,
                interests,
                bio
            };
            currentUser.profileCompleted = true;
            
            // Save to localStorage
            localStorage.setItem('travelBuddyUser', JSON.stringify(currentUser));
            
            // Update users list
            const users = JSON.parse(localStorage.getItem('travelBuddyUsers')) || [];
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex] = currentUser;
                localStorage.setItem('travelBuddyUsers', JSON.stringify(users));
            }
            
            showPage('matchesPage');
        }

        // Filter matches function
        function filterMatches(filterType) {
            // Update active filter button
            document.getElementById('filterAll').classList.remove('active-filter');
            document.getElementById('filterDestination').classList.remove('active-filter');
            document.getElementById('filterStyle').classList.remove('active-filter');
            document.getElementById('filterDates').classList.remove('active-filter');
            
            document.getElementById('filterAll').classList.add('bg-gray-200', 'dark:bg-gray-700');
            document.getElementById('filterDestination').classList.add('bg-gray-200', 'dark:bg-gray-700');
            document.getElementById('filterStyle').classList.add('bg-gray-200', 'dark:bg-gray-700');
            document.getElementById('filterDates').classList.add('bg-gray-200', 'dark:bg-gray-700');
            
            document.getElementById('filterAll').classList.remove('text-white');
            document.getElementById('filterDestination').classList.remove('text-white');
            document.getElementById('filterStyle').classList.remove('text-white');
            document.getElementById('filterDates').classList.remove('text-white');
            
            // Activate selected filter
            document.getElementById(`filter${filterType.charAt(0).toUpperCase() + filterType.slice(1)}`).classList.add('active-filter');
            document.getElementById(`filter${filterType.charAt(0).toUpperCase() + filterType.slice(1)}`).classList.remove('bg-gray-200', 'dark:bg-gray-700');
            
            currentFilter = filterType;
            renderMatches();
        }

        // Matches functions
        function renderMatches() {
            const container = document.getElementById('matchProfiles');
            container.innerHTML = '';
            
            // Filter matches based on current filter
            let filteredMatches = sampleMatches;
            
            if (currentUser && currentUser.profile) {
                const userDestination = currentUser.profile.destination;
                const userTravelDate = currentUser.profile.travelDate;
                const userTravelStyle = currentUser.profile.travelStyle;
                
                if (currentFilter === 'destination') {
                    filteredMatches = sampleMatches.filter(match => 
                        match.destination === userDestination
                    );
                } else if (currentFilter === 'style') {
                    filteredMatches = sampleMatches.filter(match => 
                        match.style === userTravelStyle
                    );
                } else if (currentFilter === 'dates') {
                    filteredMatches = sampleMatches.filter(match => 
                        match.travelDate === userTravelDate
                    );
                }
                // 'all' filter shows all matches
            }
            
            if (filteredMatches.length === 0) {
                container.innerHTML = `
                    <div class="col-span-3 text-center py-12">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <h3 class="text-xl font-semibold mb-2">No matches found yet</h3>
                        <p class="text-gray-600 dark:text-gray-400">Try adjusting your travel preferences or check back later.</p>
                    </div>
                `;
                return;
            }
            
            filteredMatches.forEach(match => {
                const card = document.createElement('div');
                card.className = 'bg-white dark:bg-gray-900 rounded-lg shadow-md overflow-hidden fade-in';
                card.innerHTML = `
                    <div class="relative">
                        <img src="${match.img}" alt="${match.name}" class="match-image"/>
                        <div class="absolute top-3 right-3 bg-primary text-white text-xs font-bold px-2 py-1 rounded-full">
                            ${match.compatibility}% Match
                        </div>
                    </div>
                    <div class="p-4">
                        <div class="flex justify-between items-start mb-2">
                            <h2 class="text-xl font-semibold">${match.name}, ${match.age}</h2>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 mb-2 flex items-center gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            ${match.location}
                        </p>
                        <p class="text-gray-600 dark:text-gray-400 mb-2 flex items-center gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Traveling to: ${match.destination}
                        </p>
                        <p class="text-gray-600 dark:text-gray-400 mb-2 flex items-center gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            ${new Date(match.travelDate).toLocaleDateString()}
                        </p>
                        <p class="text-gray-600 dark:text-gray-400 mb-2">
                            <span class="font-medium">Style:</span> ${match.style}
                        </p>
                        <p class="text-gray-600 dark:text-gray-400 mb-3">
                            <span class="font-medium">Interests:</span> ${match.interests.join(', ')}
                        </p>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-2">${match.bio}</p>
                        <div class="flex gap-2">
                            <button onclick="startChat(${match.id})" class="flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 font-medium">Chat</button>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Chat functions
        function startChat(matchId) {
            const match = sampleMatches.find(m => m.id === matchId);
            if (!match) return;
            
            currentChatWith = match;
            
            // Set chat user info
            document.getElementById('chatUserImage').src = match.img;
            document.getElementById('chatUserName').textContent = match.name;
            document.getElementById('chatUserInfo').textContent = `Traveling to ${match.destination} • ${match.style}`;
            
            // Load chat messages
            const chatKey = `chat_${currentUser.id}_${match.id}`;
            const messages = JSON.parse(localStorage.getItem(chatKey)) || [];
            
            // Render messages
            const chatBox = document.getElementById('chatBox');
            chatBox.innerHTML = '';
            
            if (messages.length === 0) {
                chatBox.innerHTML = `
                    <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                        <p>No messages yet. Start the conversation!</p>
                    </div>
                `;
            } else {
                messages.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `mb-4 ${msg.sender === 'You' ? 'text-right' : ''}`;
                    messageDiv.innerHTML = `
                        <div class="inline-block max-w-xs md:max-w-md rounded-lg px-4 py-2 ${msg.sender === 'You' ? 'bg-primary text-white' : 'bg-gray-200 dark:bg-gray-700'}">
                            <p>${msg.text}</p>
                            <p class="text-xs mt-1 opacity-70">${msg.time}</p>
                        </div>
                    `;
                    chatBox.appendChild(messageDiv);
                });
            }
            
            chatBox.scrollTop = chatBox.scrollHeight;
            
            showPage('chatPage');
        }

        function sendMessage() {
            if (!currentChatWith) return;
            
            const input = document.getElementById('messageInput');
            const messageText = input.value.trim();
            
            if (!messageText) return;
            
            // Create message
            const message = {
                text: messageText,
                sender: 'You',
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            };
            
            // Save to localStorage
            const chatKey = `chat_${currentUser.id}_${currentChatWith.id}`;
            const messages = JSON.parse(localStorage.getItem(chatKey)) || [];
            messages.push(message);
            localStorage.setItem(chatKey, JSON.stringify(messages));
            
            // Clear input
            input.value = '';
            
            // Re-render chat
            startChat(currentChatWith.id);
            
            // Simulate a reply after a short delay
            setTimeout(() => {
                const replies = [
                    "That sounds great! I'm really excited about this trip.",
                    "I've been there before, I can recommend some amazing places!",
                    "What kind of activities are you most interested in?",
                    "I'm flexible with dates, we can coordinate our schedules.",
                    "I love that idea! Let's plan it together."
                ];
                
                const randomReply = replies[Math.floor(Math.random() * replies.length)];
                const replyMessage = {
                    text: randomReply,
                    sender: currentChatWith.name,
                    time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                };
                
                messages.push(replyMessage);
                localStorage.setItem(chatKey, JSON.stringify(messages));
                
                // Re-render chat if still on chat page
                if (document.getElementById('chatPage').classList.contains('hidden') === false) {
                    startChat(currentChatWith.id);
                }
            }, 2000);
        }
    </script>
</body>
</html>